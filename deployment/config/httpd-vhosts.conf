# Virtual Hosts Configuration
# XAMPP Apache Configuration for Web Application

# Listen on specific IP and port
Listen 192.168.1.10:9090

# Default virtual host
<VirtualHost 192.168.1.10:9090>
    DocumentRoot "C:/xampp/htdocs"
    ServerName localhost
    
    <Directory "C:/xampp/htdocs">
        Options Indexes FollowSymLinks Includes ExecCGI
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost>

# Web Application Virtual Host
<VirtualHost 192.168.1.10:9090>
    ServerAdmin admin@localhost
    DocumentRoot "C:/xampp/htdocs/webapp"
    ServerName 192.168.1.10
    ServerAlias localhost
    
    # Logging
    ErrorLog "logs/webapp-error.log"
    CustomLog "logs/webapp-access.log" combined
    
    # Directory configuration
    <Directory "C:/xampp/htdocs/webapp">
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
        
        # Security headers
        Header always set X-Frame-Options "SAMEORIGIN"
        Header always set X-Content-Type-Options "nosniff"
        Header always set X-XSS-Protection "1; mode=block"
        
        # PHP settings
        php_value upload_max_filesize 10M
        php_value post_max_size 10M
        php_value max_execution_time 300
        php_value max_input_time 300
    </Directory>
    
    # Deny access to sensitive files and directories
    <DirectoryMatch "^/.*/\.(git|svn|htaccess)">
        Require all denied
    </DirectoryMatch>
    
    <FilesMatch "^\.">
        Require all denied
    </FilesMatch>
    
    <FilesMatch "(config\.php|composer\.(json|lock))$">
        Require all denied
    </FilesMatch>
    
    # Logs directory - deny web access
    <Directory "C:/xampp/htdocs/webapp/logs">
        Require all denied
    </Directory>
    
    # Schema directory - deny web access
    <Directory "C:/xampp/htdocs/webapp/schema">
        Require all denied
    </Directory>
</VirtualHost>

# phpMyAdmin configuration (allow external access)
<VirtualHost 192.168.1.10:9090>
    ServerName 192.168.1.10
    
    Alias /phpmyadmin "C:/xampp/phpMyAdmin"
    
    <Directory "C:/xampp/phpMyAdmin">
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Require all granted
        
        # Allow access from anywhere (configure based on your security needs)
        # For more security, replace with:
        # Require ip 192.168.1.0/24
        # Or specific IPs:
        # Require ip 192.168.1.100 192.168.1.101
    </Directory>
</VirtualHost>
